{
    "global_features": {
        "input_layer": "state",
        "output_layer": "Q",
        "loss": "loss",
        "optimizer": "rmsprop"        
    },
    
    "placeholders": [
        {
            "name": "state",
            "data_type": "float32",
            "kwargs": {
                "shape": ["None", 30, 45, 1],
                "name": "state"
            } 
        },

        {
            "name": "action",
            "data_type": "int32",
            "kwargs": {
                "shape": ["None"],
                "name": "action"
            }   
        },

        {
            "name": "target_q",
            "data_type": "float32",
            "kwargs": {
                "shape": ["None", "None"],
                "name": "target_q"
            }
        } 
    ],

    "layers": [
        {
            "name": "CONV_1",
            "type": "conv2d",
            "input": "state",
            "kwargs": {
                "scope": "CONV_1",
                "num_outputs": 8, 
                "kernel_size": [6, 6],
                "stride": [3, 3],
                "data_format": "NHWC",
                "padding": "VALID"
            }
        },

        {
            "name": "CONV_2",
            "type": "conv2d",
            "input": "CONV_1",
            "kwargs": {
                "scope": "CONV_2",
                "num_outputs": 8, 
                "kernel_size": [6, 6],
                "stride": [3, 3],
                "data_format": "NHWC",
                "padding": "VALID"
            }
        },

        {
            "name": "CONV_2_FLAT",
            "type": "flatten",
            "input": "CONV_2",
            "kwargs": {
                "scope": "CONV_2_FLAT"
            }
        },

        {
            "name": "FC_1",
            "type": "fully_connected",
            "input": "CONV_2_FLAT",
            "kwargs": {
                "scope": "FC_1",        
                "num_outputs": 128
            }
        },

        {
            "name": "Q",
            "type": "fully_connected",
            "input": "FC_1",
            "kwargs": {
                "scope": "Q",
                "num_outputs": 5
            }
        }
    ],

    "ops": [
        {
            "name": "best_action",
            "type": "argmax",
            "input": "Q",
            "kwargs": {
                "axis": 1,
                "name": "best_action"
            }
        },

        {
            "name": "loss",
            "type": "mean_squared_error",
            "input": [
                "Q",
                "target_q"
            ],
            "kwargs": {
                "scope": "loss"
            } 
        }
    ]
}